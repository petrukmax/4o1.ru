<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
            <title>Настройка PHP 5.2 и PHP 5.3 на одном сервере - Blog </title>
        <meta name="description" content="Настройка PHP 5.2 (через fastcgi) и PHP 5.3 (как модуль Apache2) на одном сервере это возможно!На одном сервере с одним Apache2 прекрасно заводятся и соседствуют PHP 5.2 (через fastcgi) и PHP 5.3 (как модуль Apache2). Мы далее решим проблему так, что указать какой именно PHP использовать можно будет на уровне настроек виртуального хоста." />
         
        <meta name="generator" content="Publii Open-Source CMS for Static Site" />

        <link rel="canonical" href="http://4o1.ru/nastroyka-php-52-i-php-53-na-odnom-servere.html">
        <link rel="alternate" type="application/atom+xml" href="http://4o1.ru/feed.xml" />
<link rel="alternate" type="application/json" href="http://4o1.ru/feed.json" />

        <meta property="og:title" content="Настройка PHP 5.2 и PHP 5.3 на одном сервере" /><meta property="og:site_name" content="Blog" /><meta property="og:description" content="Настройка PHP 5.2 (через fastcgi) и PHP 5.3 (как модуль Apache2) на одном сервере это возможно!На одном сервере с одним Apache2 прекрасно заводятся и соседствуют PHP 5.2 (через fastcgi) и PHP 5.3 (как модуль Apache2). Мы далее решим проблему так, что указать какой именно PHP использовать можно будет на уровне настроек виртуального хоста." /><meta property="og:url" content="http://4o1.ru/nastroyka-php-52-i-php-53-na-odnom-servere.html" /><meta property="og:type" content="article" />
        
        
        <link rel="stylesheet" href="http://4o1.ru/assets/css/fontawesome-all.min.css?v=85514f933f9e0b82460af63f1a403fa5">
        <link rel="stylesheet" href="http://4o1.ru/assets/css/style.css?v=9274fb62a8095432057114afc1a7f7fc">
        <noscript><link rel="stylesheet" href="http://4o1.ru/assets/css/noscript.css?v=efa867a99f5064d6729e4dc2008ad50b"></noscript>
        <script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"http://4o1.ru/nastroyka-php-52-i-php-53-na-odnom-servere.html"},"headline":"Настройка PHP 5.2 и PHP 5.3 на одном сервере","datePublished":"2012-09-11T18:34+04:00","dateModified":"2024-08-19T17:46+03:00","description":"Настройка PHP 5.2 (через fastcgi) и PHP 5.3 (как модуль Apache2) на одном сервере это возможно!На одном сервере с одним Apache2 прекрасно заводятся и соседствуют PHP 5.2 (через fastcgi) и PHP 5.3 (как модуль Apache2). Мы далее решим проблему так, что указать какой именно PHP использовать можно будет на уровне настроек виртуального хоста.","author":{"@type":"Person","name":"GUIDETO","url":"http://4o1.ru/authors/admin/"},"publisher":{"@type":"Organization","name":"GUIDETO"}}</script>
        <style>
           #wrapper > .bg {
               background-image: url(http://4o1.ru/assets/images/overlay.png), linear-gradient(0deg, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)), url();
           }
        </style>
        <noscript>
            <style>
                img[loading] {
                    opacity: 1;
                }
            </style>
        </noscript>			
        
    </head>
    <body class="is-preload post-template">
    <div id="wrapper" >


   <header id="header">
      <a class="logo" href="http://4o1.ru/">
            Blog
      </a>
   </header>

      <nav id="nav">
            <ul class="links">
                     <li>
                     <a
                        href="http://4o1.ru/tags/kouching/"
                           target="_self"
            >
                        Коучинг
                     </a>
            
               </li>
                     <li>
                     <a
                        href="http://4o1.ru/tags/psixologiya/"
                           target="_self"
            >
                        Психология
                     </a>
            
               </li>
                     <li>
                     <a
                        href="http://4o1.ru/tags/knigi/"
                           target="_self"
            >
                        Книги
                     </a>
            
               </li>
                     <li>
                     <a
                        href="http://4o1.ru/tags/video/"
                           target="_self"
            >
                        Видео
                     </a>
            
               </li>
                     <li>
                     <a
                        href="http://4o1.ru/tags/biz/"
                           target="_self"
            >
                        Бизнес
                     </a>
            
               </li>
                     <li>
                     <a
                        href="http://4o1.ru/tags/bez-rubriki/"
                           target="_self"
            >
                        Без рубрики
                     </a>
            
               </li>
                     <li>
                     <a
                        href="http://4o1.ru/tags/audiobook/"
                           target="_self"
            >
                        Аудиокниги
                     </a>
            
               </li>
                     <li>
                     <a
                        href="http://4o1.ru/tags/anglijskij/"
                           target="_self"
            >
                        Английский
                     </a>
            
               </li>
                     <li class="has-submenu">
                     <a
                        href="http://4o1.ru/tags/it/"
                           target="_self"
                           aria-haspopup="true"
                        >
                        IT
                     </a>
            
                     <ul class="nav__submenu level-2" aria-hidden="true" >
                              <li>
                              <a
                                 href="http://4o1.ru/tags/wordpress/"
                                    target="_self"
                     >
                                 WordPress
                              </a>
                     
                        </li>
                              <li>
                              <a
                                 href="http://4o1.ru/tags/seo/"
                                    target="_self"
                     >
                                 SEO
                              </a>
                     
                        </li>
                              <li class="has-submenu">
                              <a
                                 href="http://4o1.ru/tags/yazyki/"
                                    target="_self"
                                    aria-haspopup="true"
                                 >
                                 Языки
                              </a>
                     
                              <ul class="nav__submenu level-3" aria-hidden="true" >
                                       <li>
                                       <a
                                          href="http://4o1.ru/tags/html/"
                                             target="_self"
                              >
                                          HTML
                                       </a>
                              
                                 </li>
                                       <li>
                                       <a
                                          href="http://4o1.ru/tags/php/"
                                             target="_self"
                              >
                                          PHP
                                       </a>
                              
                                 </li>
                              </ul>
                                    </li>
                              <li>
                              <a
                                 href="http://4o1.ru/tags/hard/"
                                    target="_self"
                     >
                                 Железо
                              </a>
                     
                        </li>
                              <li>
                              <a
                                 href="http://4o1.ru/tags/android/"
                                    target="_self"
                     >
                                 Android
                              </a>
                     
                        </li>
                              <li class="has-submenu">
                              <a
                                 href="http://4o1.ru/tags/windows/"
                                    target="_self"
                                    aria-haspopup="true"
                                 >
                                 Windows
                              </a>
                     
                              <ul class="nav__submenu level-3" aria-hidden="true" >
                                       <li>
                                       <a
                                          href="http://4o1.ru/tags/iis/"
                                             target="_self"
                              >
                                          IIS
                                       </a>
                              
                                 </li>
                              </ul>
                                    </li>
                              <li class="has-submenu">
                              <a
                                 href="http://4o1.ru/tags/unix/"
                                    target="_self"
                                    aria-haspopup="true"
                                 >
                                 Unix
                              </a>
                     
                              <ul class="nav__submenu level-3" aria-hidden="true" >
                                       <li>
                                       <a
                                          href="http://4o1.ru/tags/apache/"
                                             target="_self"
                              >
                                          Apache
                                       </a>
                              
                                 </li>
                                       <li>
                                       <a
                                          href="http://4o1.ru/tags/asterisk/"
                                             target="_self"
                              >
                                          Asterisk
                                       </a>
                              
                                 </li>
                              </ul>
                                    </li>
                     </ul>
                           </li>
            </ul>
                     </nav>

<main id="main">
      <article class="post">
            <header class="major">
                  <time datetime="2012-09-11T18:34" class="date">
                        сентябрь 11, 2012
                  </time>
               <h1>
                  Настройка PHP 5.2 и PHP 5.3 на одном сервере
               </h1>
               <p class="post__inner"></p>
            </header>


         <div class="post__inner post__entry">           
            <p>Настройка PHP 5.2 (через fastcgi) и PHP 5.3 (как модуль Apache2) на одном сервере это возможно!</p>
<p>

На одном сервере с одним Apache2 прекрасно заводятся и соседствуют PHP 5.2 (через fastcgi) и PHP 5.3 (как модуль Apache2). Мы далее решим проблему так, что указать какой именно PHP использовать можно будет на уровне настроек виртуального хоста.</p>

<p>

Скачиваем дистрибутив php 5.2:</p>
<p><code>wget http://www.php.net/get/php-5.2.17.tar.gz/from/ru.php.net/mirror</code></p>
<p>

Переименовываем полученный файл во что положено:</p>
<p><code>mv mirror php-5.2.17.tar.gz</code></p>
<p>

Распаковываем архив:</p>
<p><code>tar zxvf php-5.2.17.tar.gz</code></p>
<p>

Заходим в директорию:</p>
<p><code>cd php-5.2.17</code></p>
<p>

Устанавливаем зависимости:</p>
<p><code>sudo aptitude install libxml2-dev libmysqlclient-dev libcurl4-gnutls-dev libpng12-dev libjpeg62-dev</code></p>
<p>

Конфигурируем, собираем и ставим из исходников наш php 5.2 в директорию <code>/opt/php5.2</code>:</p>
<p><code>./configure --prefix=/opt/php5.2 --with-config-file-path=/opt/php5.2 --with-mysqli --with-mysql --with-curl --with-gd --with-jpeg-dir --enable-cli --enable-fastcgi --enable-discard-path --enable-force-cgi-redirect</p>
<p>Если возникают ошибки типа этих:</code></p>
<p>

error: libjpeg.(a|so) not found.</p>
<p>

Note that the MySQL client library is not bundled anymore!</p>
<p>

Cannot find libmysqlclient under /usr</p>
<p>

Они решаются вот таким способом</p>
<p>

<code>ln -s /usr/lib/i386-linux-gnu/libjpeg.so /usr/lib/libjpeg.so</code></p>
<p><code>ln -s /usr/lib/i386-linux-gnu/libpng.so /usr/lib/libpng.so</code></p>
<p>

точно также и с файлами для mysql ну а для особо ленивых есть вот такая команда:</p>
<p>

sudo ln -s /usr/lib/i386-linux-gnu/* /usr/lib/</p>
<p>

Если запускаете конфигурацию в n-ый раз то надо очистить:</p>
<p>sudo  rm -f config.cache</p>
<p>

далее после удачного завершения:</p>
<p>

make</p>
<p>make test</p>
<p>sudo make install</p>
<p>

Данные операции займут много времени! Когда всё установиться, можно убедиться в том, что на вашем сервере теперь появилась нужная версия php такой командой:</p>
<p>

<code>/opt/php5.2/bin/php -v</code></p>
<p>

Однако, про этот php пока ничего не знает наш уважаемый веб-сервер Apache2. Мы их познакомим через fastcgi.</p>
<p>

Ставим:</p>
<p><code>sudo aptitude install libapache2-mod-fastcgi</code></p>
<p>

Включаем нужные модули Apache2:</p>
<p><code>sudo a2enmod cgi fastcgi actions</code></p>
<p>

Перезапускаем Apache, чтобы модули подцепились:</p>
<p><code>sudo service apache2 restart</code></p>
<p>

Теперь создадим файл (он будет просто обёрткой, вызывающей наш исполнимый бинарник <code>/opt/php5.2/bin/php-cgi</code>, но с нужными настройками, которые вы можете изменить или дополнить):</p>
<p><code>sudo nano /usr/lib/cgi-bin/php52-cgi</code></p>
<p>

И туда поместим буквально следующее:</p>
<p><code>#!/bin/sh</p>
<p>PHPRC="/opt/php5.2/"</p>
<p>export PHPRC</p>
<p>PHP_FCGI_CHILDREN=4</p>
<p>export PHP_FCGI_CHILDREN</p>
<p>PHP_FCGI_MAX_REQUESTS=5000</p>
<p>export PHP_FCGI_MAX_REQUESTS</p>
<p>exec /opt/php5.2/bin/php-cgi</code></p>
<p>

Сделаем файл исполнимым:</p>
<p><code>sudo chmod +x /usr/lib/cgi-bin/php52-cgi</code></p>
<p>

Теперь создадим необходимую часть конфига для виртуальных хостов, которым потребуется php 5.2:</p>
<p><code>sudo nano /etc/apache2/php52.conf</code></p>
<p>

Поместим в файл следующее:</p>
<p><code><FilesMatch "\.php"></p>
<p>SetHandler application/x-httpd-php5</p>
<p></FilesMatch></p>
<p>ScriptAlias /php52-cgi /usr/lib/cgi-bin/php52-cgi</p>
<p>Action application/x-httpd-php5 /php52-cgi</p>
<p>AddHandler application/x-httpd-php5 .php</code></p>
<p>

Теперь давайте пойдём в конфиг того виртуального хоста, который должен работать с php 5.2 и добавим в него следующую строку (например, после DocumentRoot...):</p>
<p><code>...</p>
<p>Include php52.conf</p>
<p>...</code></p>
<p>

Перезапустим Apache, чтобы подцепились новые настройки виртуального хоста:</p>
<p><code>sudo service apache2 restart</code></p>
<p>

Готово! Идите на нужный хост и проверяйте: он теперь обслуживается php 5.2.</p>
<p>

Узнать версию PHP используемую на вашем хостинге можно следующим способом. Создайте документ, вставьте этот код на страницу, установите формат ввода <em>PHP code</em> и сохраните документ.</p>
<p>

<code><?php phpinfo(); ?></code></p>
<p>

Если необходимо менять стандартные настройки в файде php.ini то его надо создать в папке /opt/php5.2/</p>
<p>

Ещё несколько комманд для тестирования php:</p>
<p>

/opt/php5.2/bin/php -v</p>
<p>/opt/php5.2/bin/php -m</p>
<p>/opt/php5.2/bin/php --ini</p>
<p>php -v</p>
<p>php-cgi -m</p>
            
         </div>

            <footer class="post__inner post__footer">

                     <p class="post__last-updated">
                        This article was updated on
                           август 19, 2024
                     </p>
               
                  <div class="post__share-tag-container">
                           <div class="post__tag">
                              <h3>Tagged in:</h3>
                                 <ul>
                                       <li>
                                          <a href="http://4o1.ru/tags/apache/">Apache</a>
                                       </li>
                                       <li>
                                          <a href="http://4o1.ru/tags/it/">IT</a>
                                       </li>
                                       <li>
                                          <a href="http://4o1.ru/tags/unix/">Unix</a>
                                       </li>
                                 </ul>
                           </div>
                
                        <div class="post__share">
                           <button
                              class="post__share-button js-post__share-button icon"
                              aria-label="Share button">
                              <i class="fas fa-share-alt"></i>
                           </button>

                           <div class="post__share-popup js-post__share-popup">
                                 
                           </div>
                        </div>        
                  </div>

                  <div class="post__bio">
                        <div>
                           <h3>
                              <a href="http://4o1.ru/authors/admin/" class="invert" rel="author">GUIDETO</a>
                           </h3>
                           
                        </div>
                  </div>
            </footer>
      </article>


            <div>
               <strong>You should also read:</strong>
            </div>
            <div class="posts">                 
                     <article>
                        <header>
                              <time datetime="2013-03-30T22:04" class="date">
                                    март 30, 2013
                              </time>
                           <h2>
                              <a href="http://4o1.ru/nastroyka-w3-total-cache.html">Настройка W3 Total Cache</a>
                           </h2>
                        </header>


                        <p><p>Добрый день, сегодня я хочу рассказать о том как <strong>настроить W3 Total Cache</strong>, но для начала немного о нем. Это плагин WordPress предназначенный для кэширования всего и вся на вашем ресурсе. Фактически нет ни одного аспекта, который бы он не задевал. Он охватывает совершенно все от кэширования на сервере, до кэширования на клиенте. Использование W3 Total Cache позволяет улучшить производительность сайта по крайней мере в 10 раз, как пишут сами создатели.</p>
</p>

                           <ul class="actions special">
                              <li>
                                 <a href="http://4o1.ru/nastroyka-w3-total-cache.html" class="button">Full Story</a>
                              </li>
                           </ul>

                     </article>
                     <article>
                        <header>
                              <time datetime="2012-10-03T11:37" class="date">
                                    октябрь 3, 2012
                              </time>
                           <h2>
                              <a href="http://4o1.ru/nastroyka-asterisknow-posle-ustanovki-eng.html">Настройка AsteriskNow после установки (Eng)</a>
                           </h2>
                        </header>


                        <p><p>Well after much researching I have complied a procedure to help people install AsteiskNow from scratch. Hope this helps.</p>
<p>

Install AsteriskNOW 1.5.0 from CD.</p>
<p>After installation first boot will prompt with Setup-Agent to enter IP address, subnet mask, and gateway.</p>
<p>

# vi /etc/resolv.conf</p>
<p>(add DNS servers ex. Nameserver 192.168.1.2)</p>
<p>

# /etc/init.d/network restart</p>
<p>

# yum update</p>
<p>(reply ’y’ when prompted.)</p>
</p>

                           <ul class="actions special">
                              <li>
                                 <a href="http://4o1.ru/nastroyka-asterisknow-posle-ustanovki-eng.html" class="button">Full Story</a>
                              </li>
                           </ul>

                     </article>
                     <article>
                        <header>
                              <time datetime="2012-09-26T10:23" class="date">
                                    сентябрь 26, 2012
                              </time>
                           <h2>
                              <a href="http://4o1.ru/nastroyka-seti-v-centos.html">Настройка сети в CentOS</a>
                           </h2>
                        </header>


                        <p><p>Настройки сетевых интерфейсов в CentOS находятся в:</p>
<div>
<ol>
<li>/etc/sysconfig/network-scripts/ifcfg-ethХ</li>
</ol>
</div>
<p>

- где X номер вашего интерфеса</p>
</p>

                           <ul class="actions special">
                              <li>
                                 <a href="http://4o1.ru/nastroyka-seti-v-centos.html" class="button">Full Story</a>
                              </li>
                           </ul>

                     </article>
                     <article>
                        <header>
                              <time datetime="2012-09-24T08:39" class="date">
                                    сентябрь 24, 2012
                              </time>
                           <h2>
                              <a href="http://4o1.ru/nastroyka-ubuntu-setevym-shlyuzom-dlya-razdachi-interneta-v-lokalnuyu-set.html">Настройка Ubuntu сетевым шлюзом для раздачи интернета в локальную сеть</a>
                           </h2>
                        </header>


                        <p><p>Как машину с двумя сетевыми интерфейсами (в один поступает интернет, из другого — «выходит») сделать шлюзом.</p>
<p>

Допустим, что аппаратно-сетевая часть уже полностью настроена, на вашей машине имеются работоспособный интернет и вы видите другие компьютеры сети. Поэтому давайте разберемся что к чему, для этого введем команду:</p>
<p>

<code>ifconfig</code></p>
</p>

                           <ul class="actions special">
                              <li>
                                 <a href="http://4o1.ru/nastroyka-ubuntu-setevym-shlyuzom-dlya-razdachi-interneta-v-lokalnuyu-set.html" class="button">Full Story</a>
                              </li>
                           </ul>

                     </article>
               </div>
           


</main>

   <footer id="copyright">
       <ul><li>&copy; Massively</li><li>Design: <a href="https://html5up.net" target="_blank" rel="nofollow noopener">HTML5 UP</a></li><li>Powered by Publii</li></ul>
    </footer>
</div>

<script  src="http://4o1.ru/assets/js/jquery.min.js?v=c9771cc3e90e18f5336eedbd0fffb2cf"></script>
<script  src="http://4o1.ru/assets/js/jquery.scrollex.min.js?v=f89065e3d988006af9791b44561d7c90"></script>
<script  src="http://4o1.ru/assets/js/jquery.scrolly.min.js?v=1ed5a78bde1476875a40f6b9ff44fc14"></script>
<script  src="http://4o1.ru/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script>
<script  src="http://4o1.ru/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script>
<script  src="http://4o1.ru/assets/js/util.min.js?v=4201a626f8c9b614a663b3a1d7d82615"></script>
<script  src="http://4o1.ru/assets/js/main.min.js?v=56233c354bd814758be8bff42f7e13a5"></script>

   <script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script>





</body>
</html>

<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>FTP-Сервер proftpd - Blog</title><meta name="description" content="ProFTPd — FTP-сервер для Linux и UNIX-подобных операционных систем.ProFTPd использует лишь один конфигурационный файл «proftpd.conf», который располагается по умолчанию в:Linux — «/etc/proftpd/proftpd.conf»FreeBSD — «/usr/local/etc/proftpd.conf»Сервер может быть настроен для работы нескольких виртуальных хостов, также поддерживает chroot. Может быть запущен в виде отдельного сервера (демона) или в составе суперсервера inetd. Также поддерживает IPv6.Расширения: поддерживает модули, добавляющие SSL/TLS шифрование[1], аутентификацию через LDAP[2], работу с SQL[3], туннелирование соединений через SSH[4].Работает со следующими операционными системами: AIX, BSD/OS, Cygwin, FreeBSD[5], HP-UX, IRIX, zSeries, Linux[5] (включая Linux для IBM S/390), Mac OS X, NetBSD, OpenBSD,Solaris, Maemo. «Родная» поддержка Microsoft Windows отсутствует[6].Также имеется графический фронтенд для ProFTPd под названием gProFTPd."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="http://4o1.ru/ftp-server-proftpd.html"><link rel="alternate" type="application/atom+xml" href="http://4o1.ru/feed.xml"><link rel="alternate" type="application/json" href="http://4o1.ru/feed.json"><meta property="og:title" content="FTP-Сервер proftpd"><meta property="og:site_name" content="Blog"><meta property="og:description" content="ProFTPd — FTP-сервер для Linux и UNIX-подобных операционных систем.ProFTPd использует лишь один конфигурационный файл «proftpd.conf», который располагается по умолчанию в:Linux — «/etc/proftpd/proftpd.conf»FreeBSD — «/usr/local/etc/proftpd.conf»Сервер может быть настроен для работы нескольких виртуальных хостов, также поддерживает chroot. Может быть запущен в виде отдельного сервера (демона) или в составе суперсервера inetd. Также поддерживает IPv6.Расширения: поддерживает модули, добавляющие SSL/TLS шифрование[1], аутентификацию через LDAP[2], работу с SQL[3], туннелирование соединений через SSH[4].Работает со следующими операционными системами: AIX, BSD/OS, Cygwin, FreeBSD[5], HP-UX, IRIX, zSeries, Linux[5] (включая Linux для IBM S/390), Mac OS X, NetBSD, OpenBSD,Solaris, Maemo. «Родная» поддержка Microsoft Windows отсутствует[6].Также имеется графический фронтенд для ProFTPd под названием gProFTPd."><meta property="og:url" content="http://4o1.ru/ftp-server-proftpd.html"><meta property="og:type" content="article"><link rel="stylesheet" href="http://4o1.ru/assets/css/fontawesome-all.min.css?v=85514f933f9e0b82460af63f1a403fa5"><link rel="stylesheet" href="http://4o1.ru/assets/css/style.css?v=9274fb62a8095432057114afc1a7f7fc"><noscript><link rel="stylesheet" href="http://4o1.ru/assets/css/noscript.css?v=efa867a99f5064d6729e4dc2008ad50b"></noscript><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"http://4o1.ru/ftp-server-proftpd.html"},"headline":"FTP-Сервер proftpd","datePublished":"2012-09-06T13:45+04:00","dateModified":"2024-08-19T17:46+03:00","description":"ProFTPd — FTP-сервер для Linux и UNIX-подобных операционных систем.ProFTPd использует лишь один конфигурационный файл «proftpd.conf», который располагается по умолчанию в:Linux — «/etc/proftpd/proftpd.conf»FreeBSD — «/usr/local/etc/proftpd.conf»Сервер может быть настроен для работы нескольких виртуальных хостов, также поддерживает chroot. Может быть запущен в виде отдельного сервера (демона) или в составе суперсервера inetd. Также поддерживает IPv6.Расширения: поддерживает модули, добавляющие SSL/TLS шифрование[1], аутентификацию через LDAP[2], работу с SQL[3], туннелирование соединений через SSH[4].Работает со следующими операционными системами: AIX, BSD/OS, Cygwin, FreeBSD[5], HP-UX, IRIX, zSeries, Linux[5] (включая Linux для IBM S/390), Mac OS X, NetBSD, OpenBSD,Solaris, Maemo. «Родная» поддержка Microsoft Windows отсутствует[6].Также имеется графический фронтенд для ProFTPd под названием gProFTPd.","author":{"@type":"Person","name":"GUIDETO","url":"http://4o1.ru/authors/admin/"},"publisher":{"@type":"Organization","name":"GUIDETO"}}</script><style>#wrapper > .bg {
               background-image: url(http://4o1.ru/assets/images/overlay.png), linear-gradient(0deg, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)), url();
           }</style><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="is-preload post-template"><div id="wrapper"><header id="header"><a class="logo" href="http://4o1.ru/">Blog</a></header><nav id="nav"><ul class="links"><li><a href="http://4o1.ru/tags/kouching/" target="_self">Коучинг</a></li><li><a href="http://4o1.ru/tags/psixologiya/" target="_self">Психология</a></li><li><a href="http://4o1.ru/tags/knigi/" target="_self">Книги</a></li><li><a href="http://4o1.ru/tags/video/" target="_self">Видео</a></li><li><a href="http://4o1.ru/tags/biz/" target="_self">Бизнес</a></li><li><a href="http://4o1.ru/tags/bez-rubriki/" target="_self">Без рубрики</a></li><li><a href="http://4o1.ru/tags/audiobook/" target="_self">Аудиокниги</a></li><li><a href="http://4o1.ru/tags/anglijskij/" target="_self">Английский</a></li><li class="has-submenu"><a href="http://4o1.ru/tags/it/" target="_self" aria-haspopup="true">IT</a><ul class="nav__submenu level-2" aria-hidden="true"><li><a href="http://4o1.ru/tags/wordpress/" target="_self">WordPress</a></li><li><a href="http://4o1.ru/tags/seo/" target="_self">SEO</a></li><li class="has-submenu"><a href="http://4o1.ru/tags/yazyki/" target="_self" aria-haspopup="true">Языки</a><ul class="nav__submenu level-3" aria-hidden="true"><li><a href="http://4o1.ru/tags/html/" target="_self">HTML</a></li><li><a href="http://4o1.ru/tags/php/" target="_self">PHP</a></li></ul></li><li><a href="http://4o1.ru/tags/hard/" target="_self">Железо</a></li><li><a href="http://4o1.ru/tags/android/" target="_self">Android</a></li><li class="has-submenu"><a href="http://4o1.ru/tags/windows/" target="_self" aria-haspopup="true">Windows</a><ul class="nav__submenu level-3" aria-hidden="true"><li><a href="http://4o1.ru/tags/iis/" target="_self">IIS</a></li></ul></li><li class="has-submenu"><a href="http://4o1.ru/tags/unix/" target="_self" aria-haspopup="true">Unix</a><ul class="nav__submenu level-3" aria-hidden="true"><li><a href="http://4o1.ru/tags/apache/" target="_self">Apache</a></li><li><a href="http://4o1.ru/tags/asterisk/" target="_self">Asterisk</a></li></ul></li></ul></li></ul></nav><main id="main"><article class="post"><header class="major"><time datetime="2012-09-06T13:45" class="date">сентябрь 6, 2012</time><h1>FTP-Сервер proftpd</h1><p class="post__inner"></p></header><div class="post__inner post__entry"><p><strong>ProFTPd</strong> — FTP-сервер для Linux и UNIX-подобных операционных систем.</p><p>ProFTPd использует лишь один конфигурационный файл «proftpd.conf», который располагается по умолчанию в:</p><ul><li><strong>Linux — «/etc/proftpd/proftpd.conf»</strong></li><li><strong>FreeBSD — «/usr/local/etc/proftpd.conf»</strong></li></ul><p>Сервер может быть настроен для работы нескольких виртуальных хостов, также поддерживает chroot. Может быть запущен в виде отдельного сервера (демона) или в составе суперсервера inetd. Также поддерживает IPv6.</p><p>Расширения: поддерживает модули, добавляющие SSL/TLS шифрование<sup id="cite_ref-0">[1]</sup>, аутентификацию через LDAP<sup id="cite_ref-1">[2]</sup>, работу с SQL<sup id="cite_ref-2">[3]</sup>, туннелирование соединений через SSH<sup id="cite_ref-3">[4]</sup>.</p><p>Работает со следующими операционными системами: AIX, BSD/OS, Cygwin, FreeBSD<sup id="cite_ref-OS_4-0">[5]</sup>, HP-UX, IRIX, zSeries, Linux<sup id="cite_ref-OS_4-1">[5]</sup> (включая Linux для IBM S/390), Mac OS X, NetBSD, OpenBSD,Solaris, Maemo. «Родная» поддержка Microsoft Windows отсутствует<sup id="cite_ref-5">[6]</sup>.</p><p>Также имеется графический фронтенд для ProFTPd под названием gProFTPd.</p><p>Устанавливаем пакет proftpd:</p><p><strong>sudo aptitude install proftpd</strong></p><p>Отвечаем на появившийся вопрос о способе запуска: «самостоятельно». Открываем файл /etc/shells:</p><p><strong>sudo nano /etc/shells</strong></p><p>Добавляем в него строку:</p><p><strong>/bin/false</strong></p><p>Создаем в /HOME каталоге папку FTP-shared(Не обязательно в корне /HOME и не обязательно такое имя папки, это просто пример):</p><p><strong>sudo nano /home/FTP-shared</strong></p><p>Теперь создаем пользователя с именем userftp(ну или что поинтересней):</p><p><strong>sudo useradd userftp -p pass -d /home/FTP-shared -s /bin/false</strong></p><p><span style="text-decoration: underline;"><strong>Вместо «pass» – ввести свое слово или фразу в качестве пароля(не вводите только цифры, работать не будет).</strong> </span></p><p><span style="font-family: Arial, Helvetica, sans-serif; font-size: medium;">Корневой пользователь может поменять пароль любого другого пользователя, указав его имя как параметр программы passwd. Нужно лишь дважды ввести новый парбль.</span></p><p></p><p><strong><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: medium;"># passwd test </span></strong></p><p>В папке FTP-shared создаем две вложенные папки(называем как хотим):</p><p><strong>sudo mkdir /home/FTP-shared/public sudo mkdir /home/FTP-shared/upload</strong></p><p>Присвоим права созданным папкам:</p><p><strong>sudo chmod 755 /home/FTP-shared</strong></p><p><strong>sudo chmod 755 /home/FTP-shared/public</strong></p><p>sudo chmod 777 /home/FTP-shared/upload</p><p><em>FTP-shared</em> и <em>public</em> – только чтение. <em>upload</em> – запись. Переименовываем имеющийся конфигурационный файл proftpd.conf и создаем новый:</p><p><strong>sudo mv /etc/proftpd/proftpd.conf /etc/proftpd/proftpd.conf.old</strong></p><p>sudo nano /etc/proftpd/proftpd.conf</p><p>Добавляем в него: <a href="http://guideto.ru/wp-content/uploads/2012/09/proftpd.zip">proftpd</a> Если Вы создавали структуру папок, имя пользоватля и т.д не как в статье, то редактируйте данный файл под себя. После произведенных действий фтп-сервер будет иметь следующие параметры доступа:</p><p><strong>user (пользователь): test</strong></p><p>password (пароль): pass (тот, что присвоен для userftp)</p><p>Можно создать несколько пользователей, но все они должны быть прописаны в файле <em>proftpd.conf</em>. Если нужно сделать анонимный доступ, следует закомментировать обе секции для <em>test</em> и раскомментировать секцию для Anonymous. Сервер запущен, но с параметрами по умолчанию, перезагружаем его:</p><p><strong>sudo /etc/init.d/proftpd restart</strong></p><p>Что бы узнать, кто подключен к фтп-серверу в данный момент используется команда <em>ftptop</em> (клавиша t меняет отображение, q – выход). <strong>Полезные советы:</strong> Если нужно подключить какую-либо папку к фтп-серверу (например, проверить работу только что созданного фтп-сервера) без редактирования конфига пригодится команда:</p><p><strong>sudo mount -o bind /здесь/путь/папки/что/я/хочу/расшарить/ /home/FTP-shared/public</strong></p><p>или с доступом на запись:</p><p><strong>sudo mount -o bind /здесь/путь/папки/что/я/хочу/расшарить/ /home/FTP-shared/upload</strong></p><p>Таким образом можно в срочном порядке временно подключить папку или диск и потом отмонтировать командой:</p><p><strong>sudo umount /home/FTP-shared/public sudo umount /home/FTP-shared/upload</strong></p><p>Для постоянного доступа к нужным папкам подключаем их посредством fstab. Бэкап файла fstab:</p><p><strong>sudo cp /etc/fstab /etc/fstab.old</strong></p><p>Открываем файл /etc/fstab:</p><p><strong>sudo nano /etc/fstab</strong></p><p>и добавляем нужные пути:</p><p><strong>/здесь/путь/папки/что/я/хочу/расшарить /home/FTP-shared/public none bind 0 0</strong></p><p>Теперь даже при рестарте компьютера информация будет доступна, если сервер за роутером то только в локальной сети. Что бы увидеть фтп-сервер из интернета нужно дать ему внешний ip-адрес. Для этого следует открыть нужный порт (в данном случае 21) для локального адреса (вида 192.168.xxx.xxx) на котором висит сервер, для доступа извне. Следующим шагом нужно дать внешнему динамическому IP-адресу постоянный адрес. Сделать это можно при помощи сервиса DynDNS.com(регистрируемся), создав при помощи его удобный и запоминающийся адрес (вида moi-server.homeip.net). Устанавливаем <em>ddclient</em>:</p><p><strong>sudo apt-get install ddclient</strong></p><p>Вводим регистрационные данные с DynDNS.com на вопросы пакета. Изменяем <em>ServerName</em> «server» в файле <em>proftpd.conf</em> на <em>ServerName</em> «moi-server.homeip.net». Перезагружаем фтп-сервер:</p><p><strong>sudo /etc/init.d/proftpd restart</strong></p><p>Какие порты надо открыть:</p><p>стандартные порты для FTP :<strong> 20 и 21</strong></p><p>Плюс дополнительные порты прописываются в  /etc/proftpd/proftpd.conf.old при необходимости:</p><p><strong>PassivePorts 60000 60001</strong>  (интервал портов, который можно использовать для соединений в пассивном режиме)</p><p><strong>MasqueradeAddress ХХХ.ХХХ.ХХХ.ХХХ</strong> (Если вы работаете за NAT'ом, эта опция поможет способствовать пассивной передаче данных. Для этого укажите здесь ваш внешний адрес и откройте пассивные порты на файрволле.)</p><h3>Ошибка при подключении по FTP: "Превышено время ожидания соединения, Не могу получить список каталогов!"</h3><p>При соединении по ftp к нашему серверу возможно появление следующей ошибки:</p><p align="justify"><em>Статус: Соединяюсь с 78.46.52.106:21...</em></p><p><em>Статус: Соединение установлено, ожидание приглашения...</em></p><p>Ответ: 220 FTP Server ready.</p><p>Команда: USER ***</p><p>Ответ: 331 Password required for ***</p><p>Команда: PASS ***</p><p>Ответ: 230 User *** logged in</p><p>Статус: Соединение установлено</p><p>Статус: Получение списка каталогов...</p><p>Команда: PWD</p><p>Ответ: 257 "/" is the current directory</p><p>Команда: TYPE I</p><p>Ответ: 200 Type set to I</p><p>Команда: <strong>PASV</strong></p><p>Ответ: 227 Entering Passive Mode (78,46,52,106,171,50).</p><p>Команда: MLSD</p><p><strong>Ошибка: Превышено время ожидания соединения</strong></p><p>Ошибка: Не могу получить список каталогов!</p><p>Это означает, что фтп-клиент не может подключиться к серверу в пассивном режиме. Фаерволом на сервере перекрыты порты, которые не используются статически, а динамически выбираются. FTP-клиенты после соединения в пассивном режиме отправляют команду серверу для перехода работы на порты выше 1024 (все порты, что ниже - они зерезервированы, а остальные, за ненадобностью и в целях обеспечения безопасности у нас отключены), поэтому и возникают такие проблемы.</p><p></p><p align="justify">  Для решения данной проблемы необходимо подключаться в активном режиме. Как это сделать в двух наиболее популярных программах описано ниже.</p><p>Мини-руководство для пользователей FileZilla:</p><p>Вкладка меню <strong>Редактирование</strong> -> <strong>Настройки</strong>. Далее открывается окно, в котором слева выбираем вкладку FTP. Справа появлится группа настроек <strong>Режим передачи</strong>. По умолчанию стоит <strong>Пассивный (Рекомендуется)</strong>. Здесь-то и нужно выбрать <strong>Активный режим</strong>. Далее нажимаем на кнопку <strong>ОК</strong> и успешно подключаемся.</p><p>Мини-руководство для пользователей Total Commander:</p><p>Вкладка меню <strong>Конфигурация</strong> -> <strong>Настройка</strong>. Далее открывается окно, в котором слева выбираем вкладку FTP. Справа появлится группа настроек, последним пунктом будет <strong>Использовать пассивный режим</strong>. По умолчанию стоит галочка, которую нужно снять. Далее нажимаем на кнопку <strong>ОК</strong> и успешно подключаемся.</p><p></p><p align="justify">  Для остальных ФТП-клиентов алгоритм приблизительно такой же. Иногда проблема не устраняется из-за настроек фаервола на Вашем компьютере или в Вашей сети - как правило пишется <strong>Port failed</strong>. Решается она перенастройкой фаервола. Также были случаи, когда даже при правильной настройке фтп-клиент не хотел работать. Ситуация разрешилась переустановкой программы.</p></div><footer class="post__inner post__footer"><p class="post__last-updated">This article was updated on август 19, 2024</p><div class="post__share-tag-container"><div class="post__tag"><h3>Tagged in:</h3><ul><li><a href="http://4o1.ru/tags/it/">IT</a></li><li><a href="http://4o1.ru/tags/unix/">Unix</a></li></ul></div><div class="post__share"><button class="post__share-button js-post__share-button icon" aria-label="Share button"><i class="fas fa-share-alt"></i></button><div class="post__share-popup js-post__share-popup"></div></div></div><div class="post__bio"><div><h3><a href="http://4o1.ru/authors/admin/" class="invert" rel="author">GUIDETO</a></h3></div></div></footer></article></main><footer id="copyright"><ul><li>&copy; Massively</li><li>Design: <a href="https://html5up.net" target="_blank" rel="nofollow noopener">HTML5 UP</a></li><li>Powered by Publii</li></ul></footer></div><script src="http://4o1.ru/assets/js/jquery.min.js?v=c9771cc3e90e18f5336eedbd0fffb2cf"></script><script src="http://4o1.ru/assets/js/jquery.scrollex.min.js?v=f89065e3d988006af9791b44561d7c90"></script><script src="http://4o1.ru/assets/js/jquery.scrolly.min.js?v=1ed5a78bde1476875a40f6b9ff44fc14"></script><script src="http://4o1.ru/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="http://4o1.ru/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="http://4o1.ru/assets/js/util.min.js?v=4201a626f8c9b614a663b3a1d7d82615"></script><script src="http://4o1.ru/assets/js/main.min.js?v=56233c354bd814758be8bff42f7e13a5"></script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script></body></html>